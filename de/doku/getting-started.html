<!DOCTYPE html>
<html lang="de">
<head>
<meta name="generator" content=
"HTML Tidy for HTML5 for Linux version 5.6.0">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content=
"width=device-width, initial-scale=1">
<title>EPS-Dokumentation | Erste Schritte</title>
<link rel="stylesheet" type="text/css" href=
"/eps/docs/static/css/main.css">
<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
<script src="/eps/docs/static/js/mathjax/tex-chtml.js" id=
"MathJax-script" async></script>
<style type="text/css">
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.codehilite .hll { background-color: #ffffcc }
.codehilite { background: #f8f8f8; }
.codehilite .c { color: #8f5902; font-style: italic } /* Comment */
.codehilite .err { color: #a40000; border: 1px solid #ef2929 } /* Error */
.codehilite .g { color: #000000 } /* Generic */
.codehilite .k { color: #204a87; font-weight: bold } /* Keyword */
.codehilite .l { color: #000000 } /* Literal */
.codehilite .n { color: #000000 } /* Name */
.codehilite .o { color: #ce5c00; font-weight: bold } /* Operator */
.codehilite .x { color: #000000 } /* Other */
.codehilite .p { color: #000000; font-weight: bold } /* Punctuation */
.codehilite .ch { color: #8f5902; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #8f5902; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #8f5902; font-style: italic } /* Comment.Preproc */
.codehilite .cpf { color: #8f5902; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #8f5902; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #8f5902; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #a40000 } /* Generic.Deleted */
.codehilite .ge { color: #000000; font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #ef2929 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #000000; font-style: italic } /* Generic.Output */
.codehilite .gp { color: #8f5902 } /* Generic.Prompt */
.codehilite .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #a40000; font-weight: bold } /* Generic.Traceback */
.codehilite .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #204a87; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #204a87; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #204a87; font-weight: bold } /* Keyword.Pseudo */
.codehilite .kr { color: #204a87; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #204a87; font-weight: bold } /* Keyword.Type */
.codehilite .ld { color: #000000 } /* Literal.Date */
.codehilite .m { color: #0000cf; font-weight: bold } /* Literal.Number */
.codehilite .s { color: #4e9a06 } /* Literal.String */
.codehilite .na { color: #c4a000 } /* Name.Attribute */
.codehilite .nb { color: #204a87 } /* Name.Builtin */
.codehilite .nc { color: #000000 } /* Name.Class */
.codehilite .no { color: #000000 } /* Name.Constant */
.codehilite .nd { color: #5c35cc; font-weight: bold } /* Name.Decorator */
.codehilite .ni { color: #ce5c00 } /* Name.Entity */
.codehilite .ne { color: #cc0000; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #000000 } /* Name.Function */
.codehilite .nl { color: #f57900 } /* Name.Label */
.codehilite .nn { color: #000000 } /* Name.Namespace */
.codehilite .nx { color: #000000 } /* Name.Other */
.codehilite .py { color: #000000 } /* Name.Property */
.codehilite .nt { color: #204a87; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #000000 } /* Name.Variable */
.codehilite .ow { color: #204a87; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #f8f8f8; text-decoration: underline } /* Text.Whitespace */
.codehilite .mb { color: #0000cf; font-weight: bold } /* Literal.Number.Bin */
.codehilite .mf { color: #0000cf; font-weight: bold } /* Literal.Number.Float */
.codehilite .mh { color: #0000cf; font-weight: bold } /* Literal.Number.Hex */
.codehilite .mi { color: #0000cf; font-weight: bold } /* Literal.Number.Integer */
.codehilite .mo { color: #0000cf; font-weight: bold } /* Literal.Number.Oct */
.codehilite .sa { color: #4e9a06 } /* Literal.String.Affix */
.codehilite .sb { color: #4e9a06 } /* Literal.String.Backtick */
.codehilite .sc { color: #4e9a06 } /* Literal.String.Char */
.codehilite .dl { color: #4e9a06 } /* Literal.String.Delimiter */
.codehilite .sd { color: #8f5902; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #4e9a06 } /* Literal.String.Double */
.codehilite .se { color: #4e9a06 } /* Literal.String.Escape */
.codehilite .sh { color: #4e9a06 } /* Literal.String.Heredoc */
.codehilite .si { color: #4e9a06 } /* Literal.String.Interpol */
.codehilite .sx { color: #4e9a06 } /* Literal.String.Other */
.codehilite .sr { color: #4e9a06 } /* Literal.String.Regex */
.codehilite .s1 { color: #4e9a06 } /* Literal.String.Single */
.codehilite .ss { color: #4e9a06 } /* Literal.String.Symbol */
.codehilite .bp { color: #3465a4 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #000000 } /* Name.Function.Magic */
.codehilite .vc { color: #000000 } /* Name.Variable.Class */
.codehilite .vg { color: #000000 } /* Name.Variable.Global */
.codehilite .vi { color: #000000 } /* Name.Variable.Instance */
.codehilite .vm { color: #000000 } /* Name.Variable.Magic */
.codehilite .il { color: #0000cf; font-weight: bold } /* Literal.Number.Integer.Long */
</style>
</head>
<body>
<div id="translation-notice">
<div class="message is-info">
<div class="message-body">
<p>Diese Website wurde größtenteils automatisch von der <a href=
"/eps/docs/getting-started">englischen Version</a> übersetzt. Wir
entschuldigen uns für eventuelle Übersetzungsfehler.</p>
<span class="x" onclick=
"localStorage.setItem('translation-notice', true);notice.style.display = 'none'">x</span></div>
</div>
</div>
<script>
var notice = document.getElementById("translation-notice")
if (localStorage.getItem("translation-notice") === null && notice !== null){
        notice.style.display = "block"
}
</script>
<nav class="navbar is-dark">
<div class="navbar-brand"><span class="navbar-burger burger"
data-target="side-menu" data-toggle="collapse"><span>&nbsp;</span>
<span>&nbsp;</span> <span>&nbsp;</span></span></div>
</nav>
<div class="main">
<div class="side-menu" id="side-menu" data-toggle-class=
"is-active">
<aside class="menu">
<p class="menu-label" style="text-align:center"><a href=
"/eps/de/doku">EPS-Dokumentation</a></p>
<ul class="menu-list">
<li><a href="/eps/de/doku">Start</a></li>
<li><a href="/eps/de/doku/getting-started">Erste Schritte</a></li>
<li><a class="" href="#" data-toggle="collapse" data-target=
"page-eps-nav">EPS Service</a>
<ul class="is-hidden" id="page-eps-nav">
<li><a href="/eps/de/doku/eps-service">Übersicht</a></li>
</ul>
</li>
<li><a class="" href="#" data-toggle="collapse" data-target=
"page-proxy-nav">Proxy Service</a>
<ul class="is-hidden" id="page-proxy-nav">
<li><a href="/eps/de/doku/proxy-service">Übersicht</a></li>
<li><a href=
"/eps/de/doku/proxy-service/installation">Installation</a></li>
<li><a href=
"/eps/de/doku/proxy-service/configuration">Konfiguration</a></li>
</ul>
</li>
<li><a class="" href="#" data-toggle="collapse" data-target=
"page-sd-nav">Service Directory</a>
<ul class="is-hidden" id="page-sd-nav">
<li><a href="/eps/de/doku/service-directory">Übersicht</a></li>
<li><a href=
"/eps/de/doku/service-directory/installation">Installation</a></li>
<li><a href=
"/eps/de/doku/service-directory/configuration">Konfiguration</a></li>
</ul>
</li>
<li><a href="/eps/de/doku/kontakt">Kontakt</a></li>
<li><a href="#" data-toggle="collapse" data-target=
"menu-language-dropdown">Sprachen</a>
<ul id="menu-language-dropdown" class="is-hidden">
<li><a class="" href="/eps/docs/getting-started">English</a></li>
<li><a class="is-open is-active" href=
"/eps/de/doku/getting-started">Deutsch</a></li>
</ul>
</li>
</ul>
</aside>
</div>
<div class="with-comments">
<div class="comments"></div>
<section class="section first">
<div class="content">
<div class="content markdown">
<h1>Erste Schritte</h1>
<p>Die Integration mit der IRIS-Infrastruktur unter Verwendung des
EPS-Servers ist einfach (hoffen wir). Zunächst müssen Sie den
<code>eps</code> Server zusammen mit den Einstellungen und
Zertifikaten, die wir Ihnen zur Verfügung gestellt haben,
bereitstellen. Dies ist so einfach wie das Herunterladen der
neuesten Version von <code>eps</code> von unserem Server, das
Entpacken des Einstellungsarchivs, das wir Ihnen zur Verfügung
gestellt haben, und das Ausführen von</p>
<div class="codehilite">
<pre><code><span class="nv">EPS_SETTINGS</span><span class=
"o">=</span>path/to/settings eps server run
</code></pre></div>
<p>Dies sollte einen lokalen JSON-RPC-Server auf Port
<code>5555</code> öffnen, mit dem Sie sich über TLS verbinden
können (dazu müssen Sie das Root-CA-Zertifikat zu Ihrer
Zertifikatskette hinzufügen). Dieser Server ist Ihr Gateway zu
allen IRIS-Diensten. Schauen Sie einfach nach den Diensten, die ein
bestimmter Betreiber anbietet, und senden Sie eine Anfrage, die den
Namen des Betreibers und die Dienstmethode enthält, die Sie
aufrufen möchten. Um z. B. mit dem Dienst "locations" zu
interagieren, der vom Betreiber "ls-1" bereitgestellt wird, würden
Sie einfach eine JSON-RPC-Nachricht wie diese senden:</p>
<div class="codehilite">
<pre><code><span class="p">{</span>
    <span class="nt">"method"</span><span class=
"p">:</span> <span class="s2">"ls-1.add"</span><span class=
"p">,</span>
    <span class="nt">"id"</span><span class=
"p">:</span> <span class="s2">"1"</span><span class="p">,</span>
    <span class="nt">"params"</span><span class=
"p">:</span> <span class="p">{</span>
        <span class="nt">"name"</span><span class=
"p">:</span> <span class="s2">"Ginos"</span><span class=
"p">,</span>
        <span class="nt">"id"</span><span class=
"p">:</span> <span class="s2">"af5ca4da5caa"</span>
    <span class="p">},</span>
    <span class="nt">"jsonrpc"</span><span class=
"p">:</span> <span class="s2">"2.0"</span>
<span class="p">}</span>
</code></pre></div>
<p>Das Gateway kümmert sich darum, diese Nachricht an den richtigen
Dienst weiterzuleiten und eine Antwort an Sie zurückzuschicken.</p>
<p>Wenn Sie Anfragen von anderen Diensten im IRIS-Ökosystem
akzeptieren möchten, können Sie die <code>jsonrpc_client</code>
verwenden. Dabei geben Sie einfach einen API-Endpunkt an, an den
eingehende Anfragen mit der gleichen Syntax wie oben zugestellt
werden sollen.</p>
<p>Das war's!</p>
<h2>Asynchrone Anrufe</h2>
<p>Die Anrufe, die wir oben gesehen haben, waren alle synchron, d.
h. ein Anruf führte zu einer direkten Antwort. Manchmal müssen
Aufrufe jedoch asynchron sein, z. B. weil die Beantwortung Zeit
benötigt. Wenn Sie einen asynchronen Aufruf an einen anderen Dienst
tätigen, erhalten Sie zunächst eine Bestätigung zurück. Sobald der
von Ihnen aufgerufene Dienst eine Antwort bereit hat, sendet er
diese über das Netzwerk <code>eps</code> an Sie zurück, wobei er
dieselbe <code>id</code> verwendet, die Sie angegeben haben
(wodurch Sie die Antwort mit Ihrer Anfrage abgleichen können).
Ebenso können Sie auf Aufrufe von anderen Diensten asynchron
reagieren, indem Sie die Antwort einfach mit dem Methodennamen
<code>respond</code> (ohne Dienstnamen) an Ihren lokalen
JSON-RPC-Server schieben. Vergessen Sie nicht, dieselbe
<code>id</code> anzugeben, die Sie mit der ursprünglichen Anfrage
erhalten haben, da diese die "Rücksendeadresse" der Anfrage
enthält.</p>
<h2>Integration Beispiel</h2>
<p>Um eine konkrete Vorstellung von der Integration mit der
IRIS-Infrastruktur unter Verwendung des EPS-Servers zu bekommen,
haben wir ein einfaches Demo-Setup erstellt, das alle Komponenten
veranschaulicht. Die Demo besteht aus drei Komponenten:</p>
<ul>
<li>Ein <code>eps</code> Server, der einen <code>health
department</code> simuliert, namens <code>hd-1</code></li>
<li>Eine <code>eps</code> Server-Simulation eines Betreibers, der
einen "Standort"-Dienst anbietet, namens <code>ls-1</code></li>
<li>Der tatsächliche vom Betreiber angebotene Ortungsdienst
<code>eps-ls</code> <code>ls-1</code></li>
</ul>
<h2>Aufstehen und loslegen</h2>
<p>Lesen Sie bitte zuerst in der README nach, wie Sie alle
notwendigen TLS-Zertifikate erstellen und die Software bauen.
Starten Sie dann die einzelnen Dienste auf verschiedenen
Terminals:</p>
<div class="codehilite">
<pre><code><span class=
"c1"># run the `eps` server of the "locations" operator ls-1</span>
<span class="nv">EPS_SETTINGS</span><span class=
"o">=</span>settings/dev/roles/ls-1 eps --level debug server run
<span class=
"c1"># run the `eps` server of the health department hd-1</span>
<span class="nv">EPS_SETTINGS</span><span class=
"o">=</span>settings/dev/roles/hd-1 eps --level debug server run
<span class="c1"># run the "locations" service</span>
eps-ls
</code></pre></div>
<h2>Testen</h2>
<p>Jetzt sollte Ihr System einsatzbereit sein. Der Demo-Dienst
"locations" bietet eine einfache, authentifizierungsfreie
JSON-RPC-Schnittstelle mit zwei Methoden: <code>add</code>, die
einen Ort zur Datenbank hinzufügt, und <code>lookup</code>, die
einen Ort anhand seiner <code>name</code> nachschlägt. Zum
Beispiel, um dem Dienst einen Ort hinzuzufügen:</p>
<div class="codehilite">
<pre><code>curl --cacert settings/dev/certs/root.crt --resolve hd-1:5555:127.0.0.1 https://hd-1:5555/jsonrpc --header <span class="s2">"Content-Type: application/json"</span> --data <span class="s1">'{"method": "ls-1.add", "id": "1", "params": {"name": "Ginos", "id": "af5ca4da5caa"}, "jsonrpc": "2.0"}'</span> <span class="m">2</span>&gt;/dev/null <span class="p">|</span> jq 
</code></pre></div>
<p>Dies sollte eine einfache JSON-Antwort zurückgeben:</p>
<div class="codehilite">
<pre><code><span class="p">{</span>
  <span class="nt">"jsonrpc"</span><span class=
"p">:</span> <span class="s2">"2.0"</span><span class="p">,</span>
  <span class="nt">"result"</span><span class=
"p">:</span> <span class="p">{</span>
    <span class="nt">"_"</span><span class=
"p">:</span> <span class="s2">"ok"</span>
  <span class="p">},</span>
  <span class="nt">"id"</span><span class="p">:</span> <span class=
"s2">"1"</span>
<span class="p">}</span>
</code></pre></div>
<p>Die Anfrage ging zunächst an den <code>eps</code> Server des
Gesundheitsamtes, wurde über gRPC zunächst an den <code>ls-1</code>
's <code>eps</code> Server weitergeleitet und wurde dann an die
JSON-RPC API des dort laufenden lokalen <code>eps-ls</code>
Dienstes übergeben. Das Ergebnis wurde dann entlang der gesamten
Kette zurückgereicht.</p>
<p>Sie können auch eine Suche nach dem Ort durchführen, den Sie
gerade hinzugefügt haben:</p>
<div class="codehilite">
<pre><code>curl --cacert settings/dev/certs/root.crt --resolve hd-1:5555:127.0.0.1 https://hd-1:5555/jsonrpc --header <span class="s2">"Content-Type: application/json"</span> --data <span class="s1">'{"method": "ls-1.lookup", "id": "1", "params": {"name": "Ginos"}, "jsonrpc": "2.0"}'</span> <span class="m">2</span>&gt;/dev/null <span class="p">|</span> jq .
</code></pre></div>
<p>die Folgendes zurückgeben sollte</p>
<div class="codehilite">
<pre><code><span class="p">{</span>
  <span class="nt">"jsonrpc"</span><span class=
"p">:</span> <span class="s2">"2.0"</span><span class="p">,</span>
  <span class="nt">"result"</span><span class=
"p">:</span> <span class="p">{</span>
    <span class="nt">"id"</span><span class=
"p">:</span> <span class="s2">"af5ca4da5caa"</span><span class=
"p">,</span>
    <span class="nt">"name"</span><span class=
"p">:</span> <span class="s2">"Ginos"</span>
  <span class="p">},</span>
  <span class="nt">"id"</span><span class="p">:</span> <span class=
"s2">"1"</span>
<span class="p">}</span>
</code></pre></div>
<p>Daher ist die Interaktion mit dem entfernten "locations"-Dienst
genauso wie der Aufruf eines lokalen JSON-RPC-Dienstes, außer dass
Sie den Namen des Operators, der den Dienst ausführt,
<code>ls-1.lookup</code>, angeben, anstatt einfach
<code>lookup</code> aufzurufen.</p>
</div>
</div>
</section>
</div>
</div>
<script defer type="text/javascript" src=
"/eps/docs/static/js/bulma.js"></script>
</body>
</html>
