<!DOCTYPE html>
<html lang="de">
<head>
<meta name="generator" content=
"HTML Tidy for HTML5 for Linux version 5.6.0">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content=
"width=device-width, initial-scale=1">
<title>EPS-Dokumentation | Proxy Service - Übersicht</title>
<link rel="stylesheet" type="text/css" href=
"/docs/static/css/main.css">
<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
<script src="/docs/static/js/mathjax/tex-chtml.js" id=
"MathJax-script" async></script>
<style type="text/css">
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .tango .hll { background-color: #ffffcc }
.highlight .tango { background: #f8f8f8; }
.highlight .tango .c { color: #8f5902; font-style: italic } /* Comment */
.highlight .tango .err { color: #a40000; border: 1px solid #ef2929 } /* Error */
.highlight .tango .g { color: #000000 } /* Generic */
.highlight .tango .k { color: #204a87; font-weight: bold } /* Keyword */
.highlight .tango .l { color: #000000 } /* Literal */
.highlight .tango .n { color: #000000 } /* Name */
.highlight .tango .o { color: #ce5c00; font-weight: bold } /* Operator */
.highlight .tango .x { color: #000000 } /* Other */
.highlight .tango .p { color: #000000; font-weight: bold } /* Punctuation */
.highlight .tango .ch { color: #8f5902; font-style: italic } /* Comment.Hashbang */
.highlight .tango .cm { color: #8f5902; font-style: italic } /* Comment.Multiline */
.highlight .tango .cp { color: #8f5902; font-style: italic } /* Comment.Preproc */
.highlight .tango .cpf { color: #8f5902; font-style: italic } /* Comment.PreprocFile */
.highlight .tango .c1 { color: #8f5902; font-style: italic } /* Comment.Single */
.highlight .tango .cs { color: #8f5902; font-style: italic } /* Comment.Special */
.highlight .tango .gd { color: #a40000 } /* Generic.Deleted */
.highlight .tango .ge { color: #000000; font-style: italic } /* Generic.Emph */
.highlight .tango .gr { color: #ef2929 } /* Generic.Error */
.highlight .tango .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .tango .gi { color: #00A000 } /* Generic.Inserted */
.highlight .tango .go { color: #000000; font-style: italic } /* Generic.Output */
.highlight .tango .gp { color: #8f5902 } /* Generic.Prompt */
.highlight .tango .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.highlight .tango .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .tango .gt { color: #a40000; font-weight: bold } /* Generic.Traceback */
.highlight .tango .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.highlight .tango .kd { color: #204a87; font-weight: bold } /* Keyword.Declaration */
.highlight .tango .kn { color: #204a87; font-weight: bold } /* Keyword.Namespace */
.highlight .tango .kp { color: #204a87; font-weight: bold } /* Keyword.Pseudo */
.highlight .tango .kr { color: #204a87; font-weight: bold } /* Keyword.Reserved */
.highlight .tango .kt { color: #204a87; font-weight: bold } /* Keyword.Type */
.highlight .tango .ld { color: #000000 } /* Literal.Date */
.highlight .tango .m { color: #0000cf; font-weight: bold } /* Literal.Number */
.highlight .tango .s { color: #4e9a06 } /* Literal.String */
.highlight .tango .na { color: #c4a000 } /* Name.Attribute */
.highlight .tango .nb { color: #204a87 } /* Name.Builtin */
.highlight .tango .nc { color: #000000 } /* Name.Class */
.highlight .tango .no { color: #000000 } /* Name.Constant */
.highlight .tango .nd { color: #5c35cc; font-weight: bold } /* Name.Decorator */
.highlight .tango .ni { color: #ce5c00 } /* Name.Entity */
.highlight .tango .ne { color: #cc0000; font-weight: bold } /* Name.Exception */
.highlight .tango .nf { color: #000000 } /* Name.Function */
.highlight .tango .nl { color: #f57900 } /* Name.Label */
.highlight .tango .nn { color: #000000 } /* Name.Namespace */
.highlight .tango .nx { color: #000000 } /* Name.Other */
.highlight .tango .py { color: #000000 } /* Name.Property */
.highlight .tango .nt { color: #204a87; font-weight: bold } /* Name.Tag */
.highlight .tango .nv { color: #000000 } /* Name.Variable */
.highlight .tango .ow { color: #204a87; font-weight: bold } /* Operator.Word */
.highlight .tango .w { color: #f8f8f8; text-decoration: underline } /* Text.Whitespace */
.highlight .tango .mb { color: #0000cf; font-weight: bold } /* Literal.Number.Bin */
.highlight .tango .mf { color: #0000cf; font-weight: bold } /* Literal.Number.Float */
.highlight .tango .mh { color: #0000cf; font-weight: bold } /* Literal.Number.Hex */
.highlight .tango .mi { color: #0000cf; font-weight: bold } /* Literal.Number.Integer */
.highlight .tango .mo { color: #0000cf; font-weight: bold } /* Literal.Number.Oct */
.highlight .tango .sa { color: #4e9a06 } /* Literal.String.Affix */
.highlight .tango .sb { color: #4e9a06 } /* Literal.String.Backtick */
.highlight .tango .sc { color: #4e9a06 } /* Literal.String.Char */
.highlight .tango .dl { color: #4e9a06 } /* Literal.String.Delimiter */
.highlight .tango .sd { color: #8f5902; font-style: italic } /* Literal.String.Doc */
.highlight .tango .s2 { color: #4e9a06 } /* Literal.String.Double */
.highlight .tango .se { color: #4e9a06 } /* Literal.String.Escape */
.highlight .tango .sh { color: #4e9a06 } /* Literal.String.Heredoc */
.highlight .tango .si { color: #4e9a06 } /* Literal.String.Interpol */
.highlight .tango .sx { color: #4e9a06 } /* Literal.String.Other */
.highlight .tango .sr { color: #4e9a06 } /* Literal.String.Regex */
.highlight .tango .s1 { color: #4e9a06 } /* Literal.String.Single */
.highlight .tango .ss { color: #4e9a06 } /* Literal.String.Symbol */
.highlight .tango .bp { color: #3465a4 } /* Name.Builtin.Pseudo */
.highlight .tango .fm { color: #000000 } /* Name.Function.Magic */
.highlight .tango .vc { color: #000000 } /* Name.Variable.Class */
.highlight .tango .vg { color: #000000 } /* Name.Variable.Global */
.highlight .tango .vi { color: #000000 } /* Name.Variable.Instance */
.highlight .tango .vm { color: #000000 } /* Name.Variable.Magic */
.highlight .tango .il { color: #0000cf; font-weight: bold } /* Literal.Number.Integer.Long */
</style>
</head>
<body>
<script>
var notice = document.getElementById("translation-notice")
if (localStorage.getItem("translation-notice") === null && notice !== null){
        notice.style.display = "block"
}
</script>
<nav class="navbar is-dark">
<div class="navbar-brand"><span class="navbar-burger burger"
data-target="side-menu" data-toggle="collapse"><span>&nbsp;</span>
<span>&nbsp;</span> <span>&nbsp;</span></span></div>
</nav>
<div class="main">
<div class="side-menu" id="side-menu" data-toggle-class=
"is-active">
<aside class="menu">
<p class="menu-label" style="text-align:center"><a href=
"/de/doku">EPS-Dokumentation</a></p>
<ul class="menu-list">
<li><a href="/de/doku">Start</a></li>
<li><a href="/de/doku/getting-started">Erste Schritte</a></li>
<li><a class="" href="#" data-toggle="collapse" data-target=
"page-eps-nav">EPS Service</a>
<ul class="is-hidden" id="page-eps-nav">
<li><a href="/de/doku/eps-service">Übersicht</a></li>
</ul>
</li>
<li><a class="is-active" href="#" data-toggle="collapse"
data-target="page-proxy-nav">Proxy Service</a>
<ul class="" id="page-proxy-nav">
<li><a href="/de/doku/proxy-service">Übersicht</a></li>
<li><a href=
"/de/doku/proxy-service/installation">Installation</a></li>
<li><a href=
"/de/doku/proxy-service/configuration">Konfiguration</a></li>
</ul>
</li>
<li><a class="" href="#" data-toggle="collapse" data-target=
"page-sd-nav">Service Directory</a>
<ul class="is-hidden" id="page-sd-nav">
<li><a href="/de/doku/service-directory">Übersicht</a></li>
<li><a href=
"/de/doku/service-directory/installation">Installation</a></li>
<li><a href=
"/de/doku/service-directory/configuration">Konfiguration</a></li>
</ul>
</li>
<li><a href="/de/doku/kontakt">Kontakt</a></li>
<li><a href="#" data-toggle="collapse" data-target=
"menu-language-dropdown">Sprachen</a>
<ul id="menu-language-dropdown" class="is-hidden">
<li><a class="" href="/docs/proxy-service">English</a></li>
<li><a class="is-open is-active" href=
"/de/doku/proxy-service">Deutsch</a></li>
</ul>
</li>
</ul>
</aside>
</div>
<div class="with-comments">
<div class="comments"></div>
<section class="section first">
<div class="content">
<div class="content markdown">
<h1>Der EPS TLS-Passthrough-Proxy</h1>
<p>Der EPS-Server bietet einen TLS-Passthrough-Proxy-Dienst, der
eingehende TLS-Verbindungen von öffentlichen Clients an einen
internen Server weiterleiten kann, ohne die TLS-Verbindung zu
beenden. Der Dienst besteht aus zwei Servern:</p>
<ul>
<li>Ein <strong>öffentlicher Proxy</strong>, der auf einem
öffentlich zugänglichen TCP-Port auf eingehende TLS-Verbindungen
lauscht und auf einem anderen TCP-Port auf Verbindungen von
privaten Proxy-Servern.</li>
<li>Ein <strong>privater Proxy</strong>, der auf keinem TCP-Port
lauscht und sich stattdessen aktiv mit dem öffentlichen
Proxy-Server verbindet, wenn eine Verbindung für ihn verfügbar ist.
Er leitet diese Verbindung (wiederum ohne TLS zu beenden) an einen
internen Server weiter, der sie dann bearbeitet.</li>
</ul>
<p>Sowohl die privaten als auch die öffentlichen Proxys haben
zugehörige EPS-Server, über die sie miteinander kommunizieren.</p>
<p>Der private Proxy kann eingehende Verbindungen an den
öffentlichen Proxy <strong>ankündigen</strong>. Immer wenn eine
neue Verbindung diesen Proxy erreicht, vergleicht er sie mit den
Ankündigungen, die er erhalten hat. Wenn eine Übereinstimmung
gefunden wird, benachrichtigt er den privaten Proxy über eine
eingehende Verbindung über das EPS-Netzwerk und sendet ihm außerdem
ein zufälliges Token. Der private Proxy öffnet eine Verbindung zum
öffentlichen Proxy, sendet das Token und übernimmt den TCP-Stream.
Er leitet ihn an einen internen Server weiter.</p>
<h2>Demo</h2>
<p>Um diesen Mechanismus zu demonstrieren, haben wir eine
Beispielkonfiguration vorbereitet. Führen Sie einfach die folgenden
Schnipsel in verschiedenen Terminals aus (aus dem Hauptverzeichnis
im Repository):</p>
<p>`bash</p>
<h1>die Binärdateien vorbereiten</h1>
<p>make &amp;& make Beispiele</p>
<h1>erstes Terminal</h1>
<p>internal-server #öffnet einen JSON-RPC-Server auf Port 8888</p>
<h1>zweites Terminal (öffentlicher Proxy)</h1>
<p>PROXY_SETTINGS=settings/dev/roles/public-proxy-1 proxy run
public</p>
<h1>drittes Terminal (privater Proxy)</h1>
<p>PROXY_SETTINGS=settings/dev/roles/private-proxy-1 proxy run
private</p>
<h1>viertes Terminal (öffentlicher Proxy-EPS-Server)</h1>
<p>EPS_SETTINGS=settings/dev/roles/public-proxy-eps-1 eps server
run</p>
<h1>fünftes Terminal (privater Proxy-EPS-Server)</h1>
<p>EPS_SETTINGS=settings/dev/roles/private-proxy-eps-1 eps server
run `</p>
<p>Wenn alle Dienste laufen, sollten Sie in der Lage sein, eine
Anfrage an den Proxy zu senden über</p>
<p>`bash curl --cacert settings/dev/certs/root.crt --resolve
test.internal-server.local:4433:127.0.0.1
https://test.internal-server.local:4433/jsonrpc | jq .</p>
<p>`</p>
<p>Dies sollte die folgenden JSON-Daten zurückgeben:</p>
<p><code>`json { "Meldung": "Erfolg" }</code> `</p>
<p>Die Anfrage, die Sie gesendet haben, erreichte den lokalen
TLS-Server auf Port 8888 über die beiden Proxys, die über das
EPS-Netzwerk kommunizierten, um die Verbindung zu vermitteln. Toll,
nicht wahr?</p>
<h2>Stresstest</h2>
<p>Sie können den Server auch einem Stresstest mit parallelen
Anfragen unterziehen, indem Sie den <code>parallel</code>
verwenden:</p>
<p><code>`bash eq 1 2000000 | parallel -j 25 curl --cacert
settings/dev/certs/root.crt --resolve
test.internal-server.local:4433:127.0.0.1
https://test.internal-server.local:4433/jsonrpc --data "{}"</code>
`</p>
<p>Dadurch wird versucht, 25 Anfragen parallel an den Server zu
senden.</p>
</div>
</div>
</section>
</div>
</div>
<script defer type="text/javascript" src=
"/docs/static/js/bulma.js"></script>
</body>
</html>
